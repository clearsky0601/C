# 结构体与联合体

## 学习目标
- 掌握结构体的定义和使用
- 理解联合体的概念和应用
- 学会结构体数组和指针
- 了解内存对齐和优化

## 知识要点

### 结构体基础

#### 1. 结构体定义
```c
struct 结构体名 {
    数据类型 成员1;
    数据类型 成员2;
    // ...
};
```

#### 2. 结构体声明
```c
struct Point {
    int x;
    int y;
};

struct Point p1;           // 声明变量
struct Point p2 = {10, 20}; // 声明并初始化
```

#### 3. 类型别名
```c
typedef struct {
    int x;
    int y;
} Point;

Point p;  // 直接使用类型名
```

### 结构体操作

#### 1. 成员访问
```c
struct Point p;
p.x = 10;        // 点操作符
p.y = 20;

struct Point *ptr = &p;
ptr->x = 30;     // 箭头操作符
ptr->y = 40;
```

#### 2. 结构体赋值
```c
struct Point p1 = {10, 20};
struct Point p2 = p1;  // 整体赋值
```

#### 3. 结构体比较
- C语言不支持直接比较
- 需要逐个成员比较
- 可以编写比较函数

### 嵌套结构体

#### 1. 结构体包含结构体
```c
struct Rectangle {
    struct Point top_left;
    struct Point bottom_right;
};
```

#### 2. 访问嵌套成员
```c
rect.top_left.x = 0;
rect.top_left.y = 0;
```

### 结构体数组

#### 1. 声明和初始化
```c
struct Point points[3] = {
    {0, 0},
    {10, 10},
    {20, 20}
};
```

#### 2. 遍历结构体数组
```c
for (int i = 0; i < 3; i++) {
    printf("Point %d: (%d, %d)\n", i, points[i].x, points[i].y);
}
```

### 联合体

#### 1. 联合体定义
```c
union Data {
    int i;
    float f;
    char str[20];
};
```

#### 2. 联合体特点
- 所有成员共享同一块内存
- 同时只能存储一个成员的值
- 大小等于最大成员的大小

#### 3. 联合体应用
- 节省内存空间
- 类型转换
- 变体数据类型

### 位域

#### 1. 位域定义
```c
struct Flags {
    unsigned int flag1 : 1;
    unsigned int flag2 : 1;
    unsigned int value : 6;
};
```

#### 2. 位域特点
- 节省内存空间
- 用于硬件编程
- 位级别的数据控制

### 内存对齐

#### 1. 对齐规则
- 成员按照自然边界对齐
- 结构体大小是最大成员对齐的倍数
- 可能存在填充字节

#### 2. 优化建议
- 按大小排序成员
- 使用pragma pack控制对齐
- 考虑内存使用效率

## 代码说明
本目录包含结构体和联合体的完整演示，展示各种定义和使用方法。

## 编译运行
```bash
make
make run
make memory    # 内存布局演示
```

## 练习建议
1. 设计复杂的数据结构
2. 实现结构体操作函数
3. 比较结构体和联合体的内存使用
4. 练习嵌套结构体的使用

## 常见错误
1. **未初始化成员**：使用未初始化的结构体成员
2. **指针错误**：结构体指针的错误使用
3. **内存对齐**：忽略内存对齐导致的问题
4. **联合体误用**：同时使用多个联合体成员

## 下一步学习
完成本节后，你已经掌握了C语言的进阶概念，可以继续学习：
- 04-practice：实际应用（文件操作、内存管理等）
